C51 COMPILER V9.60.7.0   LCD1602                                                           05/01/2024 22:19:51 PAGE 1   


C51 COMPILER V9.60.7.0, COMPILATION OF MODULE LCD1602
OBJECT MODULE PLACED IN .\Objects\LCD1602.obj
COMPILER INVOKED BY: D:\Program\MDK51_32\C51\BIN\C51.EXE LCD1602.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\L
                    -istings\LCD1602.lst) OBJECT(.\Objects\LCD1602.obj)

line level    source

   1          #include <REGX52.H>
   2          #include <INTRINS.H>
   3          
   4          sbit LCD1602_RS=P2^6;               // æ•°æ®/æŒ‡ä»¤é€‰æ‹©ï¼Œ1ä¸ºæ•°æ®ï¼Œ0ä¸ºæŒ‡ä»¤
   5          sbit LCD1602_RW=P2^5;               // è¯»/å†™é€‰æ‹©ï¼Œ1ä¸ºè¯»ï¼Œ0ä¸ºå†™
   6          sbit LCD1602_E=P2^7;                // ä½¿èƒ½ï¼Œ1ä¸ºæ•°æ®æœ‰æ•ˆï¼Œä¸‹é™æ²¿æ‰§è¡Œå‘½ä»¤
   7          #define LCD1602_DataPort    P0      // æ•°æ®è¾“å…¥/è¾“å‡º
   8          
   9          /**
  10            * @brief @11.0592MHzï¼Œ1ms
  11            * @param  æ— 
  12            * @retval æ— 
  13            */
  14          void LCD1602_Delay(void)
  15          {
  16   1              unsigned char data i, j;
  17   1      
  18   1              _nop_();
  19   1              i = 2;
  20   1              j = 199;
  21   1              do
  22   1              {
  23   2                      while (--j);
  24   2              } while (--i);
  25   1      }
  26          
  27          /**
  28            * @brief å†™å…¥æŒ‡ä»¤
  29            * @param  Command æŒ‡ä»¤
  30            * @retval æ— 
  31            */
  32          void LCD1602_WriteCommand(unsigned char Command)
  33          {
  34   1          LCD1602_RS=0;
  35   1          LCD1602_RW=0;
  36   1          LCD1602_DataPort=Command;
  37   1          LCD1602_E=1;
  38   1          LCD1602_Delay();
  39   1          LCD1602_E=0;
  40   1          LCD1602_Delay();
  41   1      }
  42          
  43          /**
  44            * @brief å†™å…¥æ•°æ®
  45            * @param  Data æ•°æ®
  46            * @retval æ— 
  47            */
  48          void LCD1602_WriteData(unsigned char Data)
  49          {
  50   1          LCD1602_RS=1;
  51   1          LCD1602_RW=0;
  52   1          LCD1602_DataPort=Data;
  53   1          LCD1602_E=1;
  54   1          LCD1602_Delay();
C51 COMPILER V9.60.7.0   LCD1602                                                           05/01/2024 22:19:51 PAGE 2   

  55   1          LCD1602_E=0;
  56   1          LCD1602_Delay();
  57   1      }
  58          
  59          /**
  60            * @brief åˆå§‹åŒ–
  61            * @param  æ— 
  62            * @retval æ— 
  63            */
  64          void LCD1602_Init(void)
  65          {
  66   1          LCD1602_WriteCommand(0x38);     // å…«ä½æ•°æ®æ¥å£ï¼Œä¸¤è¡Œæ˜¾ç¤ºï¼Œ5*7ç‚¹é˜µ
  67   1              LCD1602_WriteCommand(0x0C);         // æ˜¾ç¤ºå¼€ï¼Œå…‰æ ‡å…³ï¼Œé—ªçƒå…³
  68   1              LCD1602_WriteCommand(0x06);     // æ•°æ®è¯»å†™æ“ä½œåï¼Œå…‰æ ‡è‡ªåŠ¨åŠ ä¸€ï¼Œç”»é¢ä¸åŠ¨
  69   1              LCD1602_WriteCommand(0x01);     // æ¸…å±
  70   1      }
  71          
  72          /**
  73            * @brief è®¾ç½®å…‰æ ‡ä½ç½®
  74            * @param  Line    è¡Œæ•°ï¼Œ1~2
  75            * @param  Column  åˆ—æ•°ï¼Œ1~16
  76            * @retval æ— 
  77            */
  78          void LCD1602_SetCursor(unsigned char Line,unsigned char Column)
  79          {
  80   1          if(Line==1) LCD1602_WriteCommand(0x80|(Column-1));
  81   1          else LCD1602_WriteCommand(0x80|(Column-1)+0x40);
  82   1      }
  83          
  84          /**
  85            * @brief æ˜¾ç¤ºå­—ç¬¦
  86            * @param  Line    è¡Œæ•°ï¼Œ1~2
  87            * @param  Column  åˆ—æ•°ï¼Œ1~16
  88            * @param  Char    å­—ç¬¦
  89            * @retval æ— 
  90            */
  91          void LCD1602_ShowChar(unsigned char Line,unsigned char Column,unsigned char Char)
  92          {
  93   1          LCD1602_SetCursor(Line,Column);
  94   1          LCD1602_WriteData(Char);
  95   1      }
  96          
  97          /**
  98            * @brief æ˜¾ç¤ºå­—ç¬¦
  99            * @param  Line    è¡Œæ•°ï¼Œ1~2
 100            * @param  Column  åˆ—æ•°ï¼Œ1~16
 101            * @param  Str     å­—ç¬¦ä¸²ï¼šåœ¨å­—ç¬¦æ•°ç»„ååŠ ä¸€ä¸ªå­—ç¬¦ä¸²ç»“æŸæ ‡å¿—ï¼Œæœ¬è´¨ä¸Šæ˜¯å­—ç¬¦æ•°ç»
             -„
 102            * @retval æ— 
 103            */
 104          void LCD1602_ShowStr(unsigned char Line,unsigned char Column,unsigned char *Str)
 105          {
 106   1          unsigned char i;
 107   1          LCD1602_SetCursor(Line,Column);
 108   1          // char z[]="ABC"; ç­‰æ•ˆäº char z[]={'A', 'B', 'C', '\0'};
 109   1          for(i=0;Str[i]!='\0';i++)
 110   1          {
 111   2              LCD1602_WriteData(Str[i]);
 112   2          }
 113   1      }
 114          
 115          /**
C51 COMPILER V9.60.7.0   LCD1602                                                           05/01/2024 22:19:51 PAGE 3   

 116            * @brief  å¹‚è¿ç®—å‡½æ•°
 117            * @param  X   åº•æ•°
 118            * @param  Y   æŒ‡æ•°
 119            * @retval Result  å¹‚è¿ç®—ç»“æœ
 120            */
 121          int LCD1602_Power(int X,int Y)
 122          {
 123   1          unsigned char i;
 124   1          int Result=1;
 125   1          for(i=0;i<Y;i++)
 126   1          {
 127   2              Result*=X;
 128   2          }
 129   1          return Result;
 130   1      }
 131          
 132          /**
 133            * @brief æ˜¾ç¤ºæ•°å­—
 134            * @param  Line    è¡Œæ•°ï¼Œ1~2
 135            * @param  Column  åˆ—æ•°ï¼Œ1~16
 136            * @param  Num     æ•°å­—ï¼Œ0~65535
 137            * @param  Length     é•¿åº¦ï¼Œ1~5
 138            * @retval æ— 
 139            */
 140          void LCD1602_ShowNum(unsigned char Line,unsigned char Column,unsigned int Num,unsigned char Length)
 141          {
 142   1          unsigned char i;
 143   1          LCD1602_SetCursor(Line,Column);
 144   1          // æ€è·¯å°±æ˜¯å°†æ•°å­—æŒ¨ä¸ªæ‹†åˆ†
 145   1          // 798/100%10=7;==>10^2==>Length-1
 146   1          // 798/10%10=9; ==>10^1==>Length-2
 147   1          // 798/1%10=8;  ==>10^0==>Length-3
 148   1          for(i=Length;i>0;i--)
 149   1          {
 150   2              // CGROMä¸­å­—ç¬¦ç ä¸å­—ç¬¦å­—æ¨¡å…³ç³»å¯¹ç…§è¡¨
 151   2              LCD1602_WriteData('0'+Num/LCD1602_Power(10,i-1)%10);
 152   2          }
 153   1      }
 154          
 155          /**
 156            * @brief æ˜¾ç¤ºæœ‰ç¬¦å·æ•°å­—
 157            * @param  Line    è¡Œæ•°ï¼Œ1~2
 158            * @param  Column  åˆ—æ•°ï¼Œ1~16
 159            * @param  Num     æ•°å­—ï¼Œ-32768~32767
 160            * @param  Length  é•¿åº¦ï¼Œ1~5
 161            * @retval æ— 
 162            */
 163          void LCD1602_ShowSignedNum(unsigned char Line,unsigned char Column,int Num,unsigned char Length)
 164          {
 165   1          unsigned char i;
 166   1          LCD1602_SetCursor(Line,Column);
 167   1          
 168   1          // æ­£è´Ÿéƒ¨åˆ†
 169   1          if(Num>=0) 
 170   1          {
 171   2              LCD1602_WriteData('+');
 172   2          }
 173   1          else 
 174   1          {
 175   2              Num=-Num;
 176   2              LCD1602_WriteData('-');
 177   2          }
C51 COMPILER V9.60.7.0   LCD1602                                                           05/01/2024 22:19:51 PAGE 4   

 178   1          
 179   1          // æ•°å­—éƒ¨åˆ†
 180   1          for(i=Length;i>0;i--)
 181   1          {
 182   2              LCD1602_WriteData('0'+Num/LCD1602_Power(10,i-1)%10);
 183   2          }
 184   1      }
 185          
 186          /**
 187            * @brief æ˜¾ç¤º16è¿›åˆ¶æ•°å­—
 188            * @param  Line    è¡Œæ•°ï¼Œ1~2
 189            * @param  Column  åˆ—æ•°ï¼Œ1~16
 190            * @param  Num     æ•°å­—ï¼Œ0x0000~0xFFFF
 191            * @param  Length  é•¿åº¦ï¼Œ1~4
 192            * @retval æ— 
 193            */
 194          void LCD1602_ShowHexNum(unsigned char Line,unsigned char Column,unsigned int Num,unsigned char Length)
 195          {
 196   1          unsigned char i,n;
 197   1          LCD1602_SetCursor(Line,Column);
 198   1      
 199   1          for(i=Length;i>0;i--)
 200   1          {
 201   2              // æ³¨æ„16è¿›åˆ¶è®¡ç®—æ–¹æ³•
 202   2              n=Num/LCD1602_Power(16,i-1)%16;
 203   2              if(n<10) LCD1602_WriteData('0'+n);
 204   2              else LCD1602_WriteData('A'+n-10);
 205   2          }
 206   1      }
 207          
 208          /**
 209            * @brief æ˜¾ç¤º16è¿›åˆ¶æ•°å­—
 210            * @param  Line    è¡Œæ•°ï¼Œ1~2
 211            * @param  Column  åˆ—æ•°ï¼Œ1~16
 212            * @param  Num     æ•°å­—ï¼Œ0000 0000 0000 0000 ~ 1111 1111 1111 1111
 213            * @param  Length  é•¿åº¦ï¼Œ1~16
 214            * @retval æ— 
 215            */
 216          void LCD1602_ShowBinNum(unsigned char Line,unsigned char Column,unsigned int Num,unsigned char Length)
 217          {
 218   1          unsigned char i;
 219   1          LCD1602_SetCursor(Line,Column);
 220   1      
 221   1          for(i=Length;i>0;i--)
 222   1          {
 223   2              // æ³¨æ„2è¿›åˆ¶è®¡ç®—æ–¹æ³•
 224   2              LCD1602_WriteData('0'+Num/LCD1602_Power(2,i-1)%2);
 225   2          }
 226   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    404    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----      27
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
